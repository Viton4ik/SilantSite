{% extends 'App/default.html' %}


{% load static %}


{% block indexHead %}
    <title>Машины</title>
{% endblock indexHead %}


{% block user %}
    <div class="user">
       <div>Пользователь: <em>"{{user}}"</em></div> 
       <div>Информация о комплектации и технических характеристиках вашей техники</div>
       <div>
            <a href="{% url 'mainPage' %}"><button class="tableChangeButtons" style="background-color:#EBE6D6;">Машины</button></a>
            <a href="{% url 'maintenancePage' %}"><button class="tableChangeButtons">Техническое обслуживание</button></a>    
            <a href="{% url 'claimPage' %}"><button class="tableChangeButtons">Рекламации</button></a>    
        </div>
    </div>

{% endblock user %}


{% block filter %}
    <div class="filter">
        <form class="filterForm" method="get" action="{% url 'mainPage' %}">

            <label for="vehicle_model"> Модель техники: </label>
            <select name="vehicle_model" id="vehicle_model">
                <option value="">All</option>
                {% for model in vehicle_models_names %}
                    <option value="{{ model }}" {% if model == selected_filter %}selected{% endif %}>{{ model }}</option>
                {% endfor %}
            </select>
            <!-- <div class="divider"> | </div> -->

            <label for="engine_model"> &nbsp;Модель двигателя: </label>
            <select name="engine_model" id="engine_model">
                <option value="">All</option>
                {% for model in engine_models_names %}
                    <option value="{{ model }}" {% if model == filter_engine_model %}selected{% endif %}>{{ model }}</option>
                {% endfor %}
            </select>

            <label for="transmission_model"> &nbsp;Модель трансмиссии: </label>
            <select name="transmission_model" id="transmission_model">
                <option value="">All</option>
                {% for model in transmission_models_names %}
                    <option value="{{ model }}" {% if model == filter_transmission_model %}selected{% endif %}>{{ model }}</option>
                {% endfor %}
            </select>


            <label for="driveAxle_model"> &nbsp;Модель ведущего моста: </label>
            <select name="driveAxle_model" id="driveAxle_model">
                <option value="">All</option>
                {% for model in driveAxle_models_names %}
                    <option value="{{ model }}" {% if model == filter_driveAxle_model %}selected{% endif %}>{{ model }}</option>
                {% endfor %}
            </select>

            <label for="steeringAxle_model"> &nbsp;Модель управляемого моста: </label>
            <select name="steeringAxle_model" id="steeringAxle_model">
                <option value="">All</option>
                {% for model in steeringAxle_models_names %}
                    <option value="{{ model }}" {% if model == filter_steeringAxle_model %}selected{% endif %}>{{ model }}</option>
                {% endfor %}
            </select>

            &nbsp;<button class="filterButtons" id="buttonApplyFilterMain" type="submit">Применить фильтр</button>
            <!-- <button type="submit" name="resetFilterButton" value="True">Сбросить фильтр</button> -->
            <!-- <input id="resetButtonFilterMain" type="reset" value="Сбросить фильтр"> -->
            &nbsp;<button class="filterButtons" id="resetButtonFilterMain">Сбросить фильтр</button>
        </form>
<!--         
        <ul>
            {% for vehicle in vehicles %}
                <li>{{ vehicle.vehicleModel }} - {{ vehicle.other_fields }}</li>
            {% endfor %}
        </ul> -->
    </div>
    <div class="user">
        <div>таблица с данными (выдача результата)</div>
     </div>
{% endblock filter %}


{% block mainPage %}

    {% if vehicles %}
    <div class="mainView">
        <table class="tableVehicles">

            <!-- {# % if request.user.is_authenticated % #} -->

            <tr style="background-color: #163E6C">
                <td style="text-align: center;">Зав. № машины</td>
                <td id="vehicleModelRowName" style="text-align: center;">Модель техники</td>
                <td id="engineModelRowName" style="text-align: center;">Модель двигателя</td>
                <td style="text-align: center;">Зав. № двигателя</td>
                <td id="transmissionModelRowName" style="text-align: center;">Модель трансмиссии</td>
                <td style="text-align: center;">Зав. № трансмиссии</td>
                <td id="driveAxleModelRowName" style="text-align: center;">Модель ведущего моста</td>
                <td style="text-align: center;">Зав. № ведущего моста</td>
                <td id="steeringAxleModelRowName" style="text-align: center;">Модель управляемого моста</td>
                <td style="text-align: center;">Зав. № управляемого моста</td>
                <td style="text-align: center; {{ hideInfo }}">Договор поставки №, дата</td>
                <td style="text-align: center; {{ hideInfo }}">Дата отгрузки с завода</td>
                <td style="text-align: center; {{ hideInfo }}">Грузополучатель (конечный потребитель)</td>
                <td style="text-align: center; {{ hideInfo }}">Адрес поставки (эксплуатации)</td>
                <td style="text-align: center; {{ hideInfo }}">Комплектация (доп. опции)</td>
                <td style="text-align: center; {{ hideInfo }}">Клиент</td>
                <td style="text-align: center; {{ hideInfo }}">Сервисная компания</td>
            </tr>
        
            <!-- {# % endif % #}  -->
        {% for vehicle in page %}

                <tr style="background-color:{% cycle 'white' '#EBE6D6' %}; text-align: center;">

                        <td>{{ vehicle.vehicleNumber }}</td>
                        <td class="vehicleModelRow">{{ vehicle.vehicleModel }}</td>
                        <td class="engineModelRow">{{ vehicle.engineModel }}</td>
                        <td>{{ vehicle.engineNumber }}</td>
                        <td class="transmissionModelRow">{{ vehicle.transmissionModel }}</td>
                        <td>{{ vehicle.transmissionNumber }}</td>
                        <td class="driveAxleModelRow">{{ vehicle.driveAxleModel }}</td>
                        <td>{{ vehicle.driveAxleNumber }}</td>
                        <td class="steeringAxleModelRow">{{ vehicle.steeringAxleModel }}</td>
                        <td>{{ vehicle.steeringAxleNumber }}</td>
                        <td style="{{ hideInfo }}">{{ vehicle.deliveryContract_N_data }}</td>
                        <td style="{{ hideInfo }}">{{ vehicle.deliveryDate }}</td>
                        <td style="{{ hideInfo }}">{{ vehicle.consignee }}</td>
                        <td style="{{ hideInfo }}">{{ vehicle.deliveryAdress }}</td>
                        <td style="{{ hideInfo }}">{{ vehicle.completeSet }}</td>
                        <td style="{{ hideInfo }}">{{ vehicle.client }}</td>
                        <td style="{{ hideInfo }}">{{ vehicle.serviceCompany }}</td>

                </tr>
        {% endfor %}
        </table>   
    {% else %}
        <h2>No vehicles</h2>
    {% endif %}
    </div>
    <script src="{% static 'js/main.js' %}"></script>

{% endblock mainPage %}


{% block pagination %}

{# Добавляем пагинацию на страницу #}
<div class="paginator" style="text-align: center;">Page: 
    {# Добавляем "<" #}
    {% if page.has_previous %}
       <a href="?page={{ page.previous_page_number }}"><</a>
    {% endif %}

    {# Информация о предыдущих страницах #}
    {% if page.has_previous %}
       <a href="?page=1">1</a>
       {% if page.previous_page_number != 1 %}
           ...
           <a href="?page={{ page.previous_page_number }}">{{ page_obj.previous_page_number }}</a>
       {% endif %}
    {% endif %}

    {# Информация о текущей странице #}
    {{ page.number }}

    {# Информация о следующих страницах #}
    {% if page.has_next or page.next_page_number == page.paginator.num_pages %}
        {% if page.next_page_number != page.paginator.num_pages %}
            <a href="?page={{ page.next_page_number }}">{{ page.next_page_number }}</a>
        {% endif %}
        {% if paginator.num_pages != page.next_page_number %}
           ...
           <a href="?page={{ page.paginator.num_pages }}">{{ page.paginator.num_pages }}</a>
        {% endif %}
    {% endif %}

    {# Добавляем ">" #}
    {% if page.has_next %}
       <a href="?page={{ page.next_page_number }}">></a>
    {% endif %}
</div>
{% endblock pagination %}